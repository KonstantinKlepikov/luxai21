# Lux AI Season 1 Specifications

## Environment

**Каждый ход ваш агент получает 3 секунды на то, чтобы представить свои действия, лишнее время не сохраняется между ходами. В каждой игре вам дается 60 секунд, которые используются каждый раз, когда вы превышаете 3-секундный лимит хода. После использования всех 60 секунд и превышения 3-секундного лимита ваш агент зависает и больше не может отправлять дополнительные действия**.

## The Map

![game_board](images/game_board.png)

**Координаты увеличиваются на восток (справа) и на юг (вниз)**. Карта **всегда представляет собой квадрат и может иметь длину 12, 16, 24 или 32 плитки.** Координата (0, 0) находится вверху слева.

Карты всегда симметричны по вертикальному или горизонтальному отражению.

## Resources

| Resource Type | Research Points Pre-requisite | Fuel Value per Unit | Units Collected per Turn |
|---------------|-------------------------------|---------------------|--------------------------|
| Wood          | 0                             | 1                   | 20                       |
| Coal          | 50                            | 10                  | 5                        |
| Uranium       | 200                           | 40                  | 2                        |

Ресурсы собираются рабочими, а затем сбрасываются, когда рабочий перемещается на CityTile, а затем превращаются в топливо для города.

Древесина может вырасти заново. Каждый ход количество древесины каждой деревянной плитки увеличивается на 2,5% от текущего количества древесины, округленного в большую сторону. Полностью выработанная деревянная плитка не вырастет заново. Только плитки с менее чем 500 древесины будут расти заново.

### Collection Mechanics

В конце каждого хода Рабочие автоматически получают ресурсы со всех смежных (север, восток, юг, запад или центр) ресурсных плиток, с которых они могут собирать ресурсы в соответствии с текущей симметричной формулой:

- Итерация по урану, углю, затем по древесным ресурсам:

  - Каждый юнит делает запросы на сбор ресурсов, чтобы собрать четное количество ресурсов из каждой смежной плитки текущего повторяемого ресурса, так что собранная сумма не превышает емкость юнита. Например. Рабочий с 60 деревом, примыкающим к 3 деревянным плиткам, просит по 14 с каждой, получает 40 дерева и тратит 2.
  - Все плитки текущего итерационного ресурса затем пытаются выполнить запросы, и если они не могут убедиться, что все невыполненные запросы получают равное количество, остаток тратится впустую. Например. если 4 рабочих добывают плитку из 25 дерева, но один из них просит только 5, а другие просят 20 древесины каждый, то сначала все рабочие получают по 5 древесины, оставляя 5 древесины. Остаток будет распределен равномерно по 1 дереву последним трем рабочим, а 2 дерева будут потрачены впустую.
  
Рабочие не могут майнить, находясь на CityTiles. Вместо этого, если есть хотя бы один рабочий на CityTile, этот CityTile будет автоматически собирать смежные ресурсы с той же скоростью, что и рабочий каждый ход, и напрямую преобразовывать их в топливо. Механика сбора CityTile такая же, как у рабочего, и вы можете рассматривать CityTile как отдельного рабочего, собирающего ресурсы.

## Actions

Юниты и CityTiles могут выполнять действия каждый ход при определенных условиях. Как правило, все действия применяются одновременно и проверяются относительно состояния игры в начале хода.

## CityTiles

A CityTile is a building that takes up one tile of space. Adjacent CityTiles collectively form a City. Each CityTile can perform a single action provided the CityTile has a Cooldown < 1.

Actions

CityTile - это здание, занимающее одну клетку пространства. Соседние CityTiles вместе образуют город. Каждый CityTile может выполнять одно действие, если время восстановления CityTile Cooldown < 1.

Действия

- Build Worker - Постройте рабочего в этом CityTile (не может построить рабочего, если текущее количество собственных рабочих + тележек равно количеству CityTiles)
- Build Cart - Постройте тележку в этом  CityTile (невозможно построить тележку, если текущее количество собственных рабочих + тележек равно количеству CityTiles)
- Research - увеличьте очки исследования своей команды на 1

## Units

Есть два типа юнитов: рабочие и тележки. Каждый юнит может выполнить одно действие, если он имеет Cooldown < 1.

Все юниты могут выбрать действие и двигаться в любом из 5 направлений: North, East, South, West, Center. Более того, все юниты могут нести ресурсы, полученные в результате автоматической добычи или передачи ресурсов. Рабочие ограничены 100 единицами ресурсов, а тележки ограничены 2000 единицами ресурсов.

Каждый раз, когда юнит перемещается на дружественный CityTile, CityTile превращает все переносимые ресурсы в топливо.

На плитках без CityTile может быть не более одного юнита. Более того, юниты не могут перемещаться поверх CityTiles противоположной команды. Однако юниты могут складываться друг на друга на дружественном CityTile.

Если два юнита пытаются переместиться на одну и ту же плитку, которая не является CityTile, это считается столкновением, и оба действия перемещения отменяется.

### Workers

Actions

- Перемещение - перемещайте юнита в одном из 5 направлений: север, восток, юг, запад, центр.
- Грабеж - Уменьшите уровень дороги на тайле, на котором находится отряд, на 0,5
- Передача - отправьте любое количество одного типа ресурса из груза юнита другому (в начале хода) соседнему юниту, вплоть до грузоподъемности последнего. Излишек возвращается исходному юниту.
- Build CityTile - Создайте CityTile прямо под этим рабочим при условии, что у рабочего есть 100 ресурсов любого типа в загрузке (полная загрузка), а тайл пуст. Если строительство прошло успешно, все перенесенные ресурсы потребляются, и новый CityTile строится с нулевыми начальными ресурсами.

### Carts

Actions

- Перемещение - перемещайте юнит в одном из 5 направлений: север, восток, юг, запад, центр.
- Передача - отправьте любое количество одного типа ресурса из груза юнита другому (в начале хода) соседнему юниту, вплоть до грузоподъемности последнего. Излишек возвращается исходному юниту.

## Cooldown

| Unit Type | Base Cooldown |
|-----------|---------------|
| CityTile | 10 |
| Worker | 2 |
| Cart | 3 |

CityTiles, Workers и Carts имеют механику восстановления после каждого действия. Юниты и CityTiles могут выполнять действие, только если у них < 1 Cooldown.

Порядок такой:

- Действия cityTile с увеличенным времени восстановления
- действия юнитов с увеличенным временивосстановления
- создание дорог
- сбор ресурсов
- ресурсы падают на cityTiles
- в ночное время потребление ресурсов юнитами, а городами - топлива
- восстановление дерева на тайтлах
- вычисление cooldown

После выполнения действия время восстановления юнита увеличивается на базовое время восстановления (см. таблицу). ночью отряды получают в 2 раза больше cooldown

Dремя восстановления каждого юнита уменьшается на 1 и далее уменьшается в зависимости от уровня дороги, на которой он находится в конце хода. На CityTiles не влияют уровни дороги, и время восстановления всегда уменьшается на 1. Минимальное время восстановления - 0.

## Roads

По мере того как тележки перемещаются по карте, они начинают прокладывать дороги, которые позволяют всем юнитам восстанавливаться быстрее (см. Cooldown). В конце каждого хода тележка будет повышать уровень дороги плитки, на которой она находитсяя, на 0,75. Все плитки начинаются с уровня дороги 0 и ограничиваются 6.

CityTiles автоматически имеет максимальный уровень дороги 6.

Рабочие также могут разрушить дороги с помощью грабежа, который каждый раз снижает уровень дороги на 0,5.

Если город поглощен тьмой, уровень дороги всех плиток в CityTiles вернется к 0.

## Day/Night Cycle

| Unit | Fuel Burn in City | Fuel Burn Outside City |
|------|-------------------|------------------------|
| CityTile| 23 - 5 * number of adjacent friendly CityTiles | N/A |
| Cart | 0 | 10 |
| Worker | 0 | 4 |

Цикл день/ночь состоит из из 40 ходов, первые 30 ходов - дневные, последние 10 - ночные. Всего в матче 360 ходов, составляющих 9 циклов.

Каждую ночь каждый объект и CityTile будут потреблять определенное количество топлива. В частности, юниты будут использовать переносимые ресурсы для производства света, тогда как CityTiles будет использовать свое топливо для производства света.

Рабочим и тележкам нужно будет потреблять ресурсы только в том случае, если они не находятся на CityTile. Находясь за пределами города, рабочие и телеги должны потреблять целые единицы ресурсов для удовлетворения своих ночных потребностей, например если рабочий несет на себе 1 дерево и 5 единиц урана, он будет потреблять полную древесину топливо, а затем полную единицу урана для удовлетворения последних 3 требований, тратя в итоге 37 единиц топлива. Юниты всегда будут в первую очередь потреблять наименее эффективные ресурсы.

Если у какого-либо юнита ночью закончится топливо, он будет удален из игры Если у Города закончится топливо, весь Город со всеми его CityTiles будет удален из игры.

## Game Resolution order

Действия в игре сначала проверяются на соответствие текущему состоянию игры, чтобы убедиться, что они действительны. Далее действия вместе с игровыми событиями разрешаются в следующем порядке и одновременно на каждом шаге

1. Действия CityTile с увеличением временем восстановления
2. Действия юнита вместе с увеличением временем восстановления
3. Создание дорог
4. Сбор ресурсов
5. Сброс ресурсов в CityTiles
6. Потеря ресурсов юнитами ночью, а в CityTiles - топлива.
7. Восстановление древесины, которая не истощилась до 0
8. Время восстановления обрабатывается / вычисляется для каждого юнита и CityTile.
9. Единственным исключением из критериев проверки является то, что отряды могут плавно перемещаться между клетками, то есть, если два отряда находятся рядом, они могут меняться местами за один ход.

В противном случае такие действия, как строительство CityTile одним юнитом, и пермещение в него другого юнита, не разрешены, поскольку в текущем состоянии этого недавно построенного города нет, А еще юниты не могут перемещаться поверх других юнитов за пределами CityTiles.

## Win Conditions

После 360 ходов?

10000 \* citytiles + 1 \* units

Игра может закончиться досрочно, если у команды больше нет юнитов или CityTiles. Тогда побеждает другая команда.
